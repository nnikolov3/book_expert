The general guidelines for initializing the S A T A controller during P O S T, S four slash S five, and S three resume are described below. Upon resuming from S three, System B I O S is responsible for restoring all registers that it initialized during P O S T. Setting the S A T A Controller Mode is a critical step in configuring the S A T A subsystem. The system B I O S must program the S A T A controller mode prior to beginning any other initialization steps or attempting to communicate with the drives. This is achieved by manipulating the S A T A Mode Select, or S M S, field of the Port Mapping register, located at Device thirty one, Function two, with an offset of hexadecimal nine zero, and the relevant bits are from index seven through six.There are three primary modes that software could be operating in: A H C I, R A I D, and I D E compatible modes. Not every mode is supported on every component, and the allowed configurations vary depending on the version of the component, whether it is mobile or desktop, and whether it is R A I D or non-R A I D. R A I D and A H C I modes require specific O S driver support and are identical except for differences in P I and C C dot S C C values. I D E mode does not have any special O S requirements and is sometimes termed compatible mode.In I D E Compatible Mode, the S A T A controller is set up to use the A T A slash I D E programming interface. The S A T A ports are controlled by two S A T A functions: one function routes up to four S A T A ports, D thirty one colon F two, and the other routes up to two S A T A ports, D thirty one colon F five, which is for desktop S K U S only. The Sub Class Code, D thirty one colon F two colon hexadecimal zero A, is set to hexadecimal zero one. This mode does not require any special O S driver support.A H C I Mode is selected by programming the S M S field to binary zero one. In this mode, the S A T A controller is set up to use the A H C I programming interface, and all six S A T A ports are controlled by a single S A T A function, D thirty one colon F two. The Sub Class Code, D thirty one colon F two colon hexadecimal zero A, is set to hexadecimal zero six. This mode requires specific O S driver support to fully leverage its advanced capabilities.R A I D Mode is enabled only on certain S K U S of the Intel components and requires an additional option R O M. The S A T A controller is set up to use the A H C I programming interface, and the S A T A ports are controlled by a single S A T A function, D thirty one colon F two. The Sub Class Code, D thirty one colon F two colon hexadecimal zero A, is set to hexadecimal zero four. This mode also requires specific O S driver support.When the system B I O S is enabling A H C I Mode or R A I D Mode, it must disable the second S A T A controller on the part, Device thirty one, Function five, by setting the S A D two bit, R C B A one hexadecimal three four one eight index twenty five. The system B I O S must also ensure that memory space, I O space, and interrupts for this device are disabled prior to disabling the device in P C I configuration space.For R A I D mode, the R A I D option R O M enables and uses the A H C I programming interface by setting the A E bit, A B A R hexadecimal zero four index thirty one. All register settings applicable to A H C I mode set by the B I O S must be set in R A I D as well. The B I O S is required to provide A H C I support to A T A P I S A T A devices, which the R A I D option R O M does not handle.P C H supports stable image compatible I D. When the alternative I D enable, D thirty one colon F two colon hexadecimal nine C index seven, is not set, the P C H S A T A controller will report Device I D as hexadecimal two eight two two for desktop S K U.The system B I O S may implement a setup option that provides the user with the ability to select the S A T A controller mode. This ensures that the operating system can be loaded and made operational on the platform if the required device driver support is not available. S A T A drives cannot start to spin up or become data-ready until the S A T A controller is properly configured and initialized. Ultimately, the system B I O S plays a crucial role in configuring the S A T A controller for optimal performance and compatibility, ensuring seamless interaction between the operating system and the storage devices. By meticulously programming the S A T A controller mode and managing the various operational modes, the system B I O S sets the stage for efficient data storage and retrieval, which is fundamental to the overall functionality of the computing system.
